@startuml Bookworm Structure

' Стили для диаграммы
skinparam backgroundColor white
skinparam classBackgroundColor #f5f5f5
skinparam classBorderColor #2c3e50
skinparam classFontColor #2c3e50
skinparam classFontSize 14
skinparam classFontName Arial
skinparam arrowColor #2c3e50
skinparam arrowFontColor #2c3e50
skinparam arrowFontSize 12

' Базовый класс активности
abstract class BaseActivity {
  # void onCreate(Bundle)
  # void onResume()
  # void onPause()
  # SupabaseAuth getSupabaseAuth()
}

' Базовый класс фрагмента
abstract class BaseFragment {
  # Context context
  # SupabaseAuth supabaseAuth
  + View onCreateView(LayoutInflater, ViewGroup, Bundle)
  + void onViewCreated(View, Bundle)
  + void onAttach(Context)
  + SupabaseAuth getSupabaseAuth()
}

' Классы активностей
class MainActivity {
  - BottomNavigationView navView
  - SupabaseService supabaseService
  + void onCreate(Bundle)
  + void onNavigationItemSelected(MenuItem)
}

class SignInActivity {
  - EditText emailField
  - EditText passwordField
  + void onCreate(Bundle)
  + void onSignInClick(View)
  + void onRegisterClick(View)
}

class SingUpActivity {
  - EditText emailField
  - EditText passwordField
  - EditText confirmPasswordField
  + void onCreate(Bundle)
  + void onSignUpClick(View)
}

class BookActivity {
  - Book book
  - TextView titleTextView
  - TextView authorTextView
  - ProgressBar progressBar
  + void onCreate(Bundle)
  + void onReadClick(View)
  + void onEditClick(View)
  + void updateBookInfo()
}

class BookReaderActivity {
  - Book currentBook
  - int currentPage
  - int totalPages
  + void onCreate(Bundle)
  + void onPageChange(int)
  + void updateReadingProgress()
}

class AddBookActivity {
  - EditText titleEditText
  - EditText authorEditText
  - Button selectFileButton
  - Button selectCoverButton
  + void onCreate(Bundle)
  + void onSelectFileClick(View)
  + void onSelectCoverClick(View)
  + void onSaveBookClick(View)
}

class EditBookActivity {
  - Book book
  - EditText titleEditText
  - EditText authorEditText
  - RatingBar ratingBar
  - EditText reviewEditText
  + void onCreate(Bundle)
  + void loadBookData()
  + void onSaveChangesClick(View)
}

class ShelfDetailActivity {
  - Shelf shelf
  - RecyclerView booksRecyclerView
  - BookAdapter bookAdapter
  + void onCreate(Bundle)
  + void loadShelfBooks()
  + void onAddBookToShelfClick(View)
}

class PersonalDataActivity {
  - EditText nameEditText
  - EditText emailEditText
  - Button saveButton
  + void onCreate(Bundle)
  + void savePersonalData()
}

class SettingsActivity {
  - Switch darkModeSwitch
  - Spinner fontSizeSpinner
  + void onCreate(Bundle)
  + void onOptionSelected(View)
}

class FilePickerActivity {
  - RecyclerView filesRecyclerView
  - String currentPath
  + void onCreate(Bundle)
  + void navigateToFolder(String)
  + void selectFile(String)
}

' Классы фрагментов
class HomeFragment {
  - RecyclerView recentBooksRecyclerView
  - TextView welcomeTextView
  - ChartView readingStatsChart
  + View onCreateView(LayoutInflater, ViewGroup, Bundle)
  + void onViewCreated(View, Bundle)
  + void loadRecentBooks()
  + void loadReadingStats()
}

class LibraryFragment {
  - RecyclerView booksRecyclerView
  - BookAdapter bookAdapter
  - List<Book> booksList
  + View onCreateView(LayoutInflater, ViewGroup, Bundle)
  + void onViewCreated(View, Bundle)
  + void loadLibrary()
  + void filterBooks(String)
}

class ShelvesFragment {
  - RecyclerView shelvesRecyclerView
  - List<Shelf> shelvesList
  + View onCreateView(LayoutInflater, ViewGroup, Bundle)
  + void onViewCreated(View, Bundle)
  + void loadShelves()
  + void onCreateShelfClick(View)
}

class ProfileFragment {
  - TextView usernameTextView
  - TextView booksReadTextView
  - Button settingsButton
  + View onCreateView(LayoutInflater, ViewGroup, Bundle)
  + void onViewCreated(View, Bundle)
  + void loadUserData()
}

' Наследование от базового класса
BaseActivity <|-- MainActivity
BaseActivity <|-- SignInActivity
BaseActivity <|-- SingUpActivity
BaseActivity <|-- BookActivity
BaseActivity <|-- BookReaderActivity
BaseActivity <|-- AddBookActivity
BaseActivity <|-- EditBookActivity
BaseActivity <|-- ShelfDetailActivity
BaseActivity <|-- PersonalDataActivity
BaseActivity <|-- SettingsActivity
BaseActivity <|-- FilePickerActivity

' Наследование фрагментов
BaseFragment <|-- HomeFragment
BaseFragment <|-- LibraryFragment
BaseFragment <|-- ShelvesFragment
BaseFragment <|-- ProfileFragment

' Навигационные связи между активностями
SignInActivity --> MainActivity : при успешной авторизации
SignInActivity --> SingUpActivity : при нажатии "Регистрация"
MainActivity --> BookActivity : при выборе книги
BookActivity --> BookReaderActivity : при нажатии "Читать"
BookActivity --> EditBookActivity : при нажатии "Редактировать"
MainActivity --> ShelfDetailActivity : при выборе полки
MainActivity --> SettingsActivity : при выборе настроек
MainActivity --> PersonalDataActivity : при выборе профиля
AddBookActivity --> FilePickerActivity : при выборе файла
EditBookActivity --> FilePickerActivity : при смене файла
ShelfDetailActivity --> BookActivity : при выборе книги

' Связи между активностями и фрагментами
MainActivity o-- HomeFragment : содержит
MainActivity o-- LibraryFragment : содержит
MainActivity o-- ShelvesFragment : содержит
MainActivity o-- ProfileFragment : содержит

' Навигация из фрагментов
HomeFragment --> BookActivity : при выборе недавней книги
LibraryFragment --> BookActivity : при выборе книги из библиотеки
LibraryFragment --> AddBookActivity : при добавлении новой книги
ShelvesFragment --> ShelfDetailActivity : при выборе полки
ShelvesFragment --> AddBookActivity : при создании новой полки
ProfileFragment --> SettingsActivity : при переходе в настройки
ProfileFragment --> PersonalDataActivity : при редактировании профиля

@enduml 